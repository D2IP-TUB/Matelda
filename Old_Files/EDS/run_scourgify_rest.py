import ed_twolevel_rahas_features 
import saving_results
import app_logger

cell_feature_generator_enabled = True
sandbox_path = "/home/fatemeh/ED-Scale/Sandbox_Generation/sandbox-parent"
tables_path = "/home/fatemeh/ED-Scale/Sandbox_Generation/sandbox-parent/data-gov-sandbox"
column_groups_path = "/home/fatemeh/scourgify-test/mediate_files_res_1o5/mediate_files/col_groups"
experiment_output_path = "/home/fatemeh/ED-Scale/outputs/160323scourgify-res1,5"
results_path = "/home/fatemeh/ED-Scale/outputs/160323scourgify-res1,5/results"
logs_dir = "/home/fatemeh/ED-Scale/EDS/logs"
logger = app_logger.get_logger(logs_dir)
labeling_budget = 10000
number_of_column_clusters = {'0': 7, '1': 5, '2': 11, '3': 20, '4': 8, '5': 6, '6': 5, '7': 5, '8': 13, '9': 9, '10': 4, '11': 5, '12': 10, '13': 18, '14': 9, '15': 6, '16': 8, '17': 12, '18': 6, '19': 7, '20': 6, '21': 5, '22': 16, '23': 6, '24': 11, '25': 14, '26': 8, '27': 22, '28': 6, '29': 6, '30': 10, '31': 4, '32': 12, '33': 40, '34': 3, '35': 6, '36': 12, '37': 6, '38': 6, '39': 4, '40': 13, '41': 5, '42': 4, '43': 3, '44': 8, '45': 5, '46': 6, '47': 5, '48': 5, '49': 9, '50': 3, '51': 4, '52': 7, '53': 6, '54': 8, '55': 5, '56': 3, '57': 42, '58': 6, '59': 6, '60': 9, '61': 21, '62': 2, '63': 4}
cluster_sizes = {'0': {'0': 259555, '1': 48586, '2': 610060, '3': 290341, '4': 404155, '5': 143879, '6': 7225}, '1': {'0': 52, '1': 52, '2': 52, '3': 52, '4': 52}, '2': {'0': 8557, '1': 16122, '2': 690316, '3': 445, '4': 20507, '5': 377393, '6': 629183, '7': 133, '8': 6847, '9': 1302, '10': 304256}, '3': {'0': 554, '1': 43234, '2': 50621, '3': 555, '4': 626, '5': 626, '6': 1806, '7': 1829, '8': 1838, '9': 1830, '10': 555, '11': 2779, '12': 2779, '13': 552, '14': 3460, '15': 554, '16': 552, '17': 84932, '18': 554, '19': 531}, '4': {'0': 11591, '1': 10752, '2': 46625, '3': 4767, '4': 20061, '5': 3240, '6': 50163, '7': 624}, '5': {'0': 248, '1': 248, '2': 248, '3': 248, '4': 248, '5': 248}, '6': {'0': 148480, '1': 74240, '2': 74240, '3': 74240, '4': 74240}, '7': {'0': 62427, '1': 128, '2': 124082, '3': 186316, '4': 186381}, '8': {'0': 506, '1': 506, '2': 506, '3': 506, '4': 506, '5': 1518, '6': 1518, '7': 506, '8': 506, '9': 506, '10': 506, '11': 506, '12': 506}, '9': {'0': 899, '1': 4495, '2': 899, '3': 8990, '4': 899, '5': 1798, '6': 3596, '7': 3596, '8': 899}, '10': {'0': 2202, '1': 2202, '2': 2202, '3': 2202}, '11': {'0': 49110, '1': 49110, '2': 49110, '3': 98220, '4': 49110}, '12': {'0': 7980, '1': 7980, '2': 7980, '3': 7980, '4': 7980, '5': 7980, '6': 7980, '7': 7980, '8': 7980, '9': 7980}, '13': {'0': 988, '1': 988, '2': 988, '3': 988, '4': 12287, '5': 988, '6': 988, '7': 988, '8': 988, '9': 1976, '10': 11299, '11': 11299, '12': 23586, '13': 11299, '14': 11299, '15': 12287, '16': 11299, '17': 11299}, '14': {'0': 42, '1': 784, '2': 742, '3': 742, '4': 952, '5': 1568, '6': 742, '7': 84, '8': 84}, '15': {'0': 478, '1': 478, '2': 478, '3': 478, '4': 478, '5': 478}, '16': {'0': 1279, '1': 1279, '2': 1279, '3': 1279, '4': 2558, '5': 1279, '6': 1279, '7': 1279}, '17': {'0': 3705, '1': 3705, '2': 3705, '3': 3705, '4': 3705, '5': 14820, '6': 3705, '7': 3705, '8': 3705, '9': 3705, '10': 7410, '11': 11115}, '18': {'0': 61802, '1': 61802, '2': 61802, '3': 61802, '4': 61802, '5': 61802}, '19': {'0': 1683, '1': 561, '2': 2805, '3': 561, '4': 561, '5': 1122, '6': 561}, '20': {'0': 5427, '1': 3618, '2': 5427, '3': 5427, '4': 1809, '5': 3618}, '21': {'0': 840, '1': 420, '2': 420, '3': 420, '4': 420}, '22': {'0': 1425, '1': 1425, '2': 286, '3': 286, '4': 286, '5': 1425, '6': 607, '7': 607, '8': 607, '9': 607, '10': 532, '11': 8114, '12': 532, '13': 532, '14': 532, '15': 10146}, '23': {'0': 108, '1': 108, '2': 108, '3': 108, '4': 108, '5': 108}, '24': {'0': 471, '1': 942, '2': 942, '3': 942, '4': 471, '5': 1413, '6': 471, '7': 471, '8': 942, '9': 471, '10': 471}, '25': {'0': 226, '1': 452, '2': 226, '3': 226, '4': 226, '5': 226, '6': 226, '7': 226, '8': 226, '9': 226, '10': 452, '11': 226, '12': 226, '13': 226}, '26': {'0': 80083, '1': 50011, '2': 50011, '3': 160166, '4': 50011, '5': 30072, '6': 30072, '7': 130094}, '27': {'0': 90, '1': 180, '2': 90, '3': 90, '4': 720, '5': 90, '6': 90, '7': 90, '8': 90, '9': 90, '10': 90, '11': 90, '12': 90, '13': 90, '14': 90, '15': 90, '16': 90, '17': 90, '18': 90, '19': 90, '20': 90, '21': 90}, '28': {'0': 49329, '1': 49329, '2': 49329, '3': 49329, '4': 49329, '5': 49329}, '29': {'0': 4637, '1': 4637, '2': 9274, '3': 4637, '4': 4637, '5': 4637}, '30': {'0': 2925, '1': 975, '2': 975, '3': 975, '4': 975, '5': 975, '6': 975, '7': 1950, '8': 1950, '9': 1950}, '31': {'0': 110, '1': 110, '2': 110, '3': 110}, '32': {'0': 2360, '1': 2360, '2': 236, '3': 236, '4': 236, '5': 236, '6': 236, '7': 3540, '8': 236, '9': 236, '10': 236, '11': 708}, '33': {'0': 273, '1': 273, '2': 273, '3': 273, '4': 273, '5': 273, '6': 273, '7': 273, '8': 273, '9': 273, '10': 273, '11': 273, '12': 2730, '13': 273, '14': 273, '15': 273, '16': 273, '17': 273, '18': 273, '19': 273, '20': 273, '21': 1092, '22': 273, '23': 273, '24': 273, '25': 273, '26': 546, '27': 819, '28': 273, '29': 273, '30': 273, '31': 273, '32': 819, '33': 2730, '34': 273, '35': 273, '36': 273, '37': 273, '38': 273, '39': 273}, '34': {'0': 108, '1': 108, '2': 108}, '35': {'0': 5946, '1': 11892, '2': 5946, '3': 5946, '4': 5946, '5': 11892}, '36': {'0': 7960, '1': 15920, '2': 15920, '3': 7960, '4': 15920, '5': 7960, '6': 7960, '7': 15920, '8': 7960, '9': 7960, '10': 7960, '11': 7960}, '37': {'0': 49114, '1': 49114, '2': 49114, '3': 49114, '4': 49114, '5': 49114}, '38': {'0': 319, '1': 319, '2': 638, '3': 319, '4': 319, '5': 319}, '39': {'0': 33739, '1': 33739, '2': 33739, '3': 33739}, '40': {'0': 17040, '1': 8520, '2': 17040, '3': 8520, '4': 8520, '5': 8520, '6': 8520, '7': 8520, '8': 8520, '9': 25560, '10': 34080, '11': 8520, '12': 17040}, '41': {'0': 61, '1': 61, '2': 61, '3': 61, '4': 61}, '42': {'0': 2139, '1': 2139, '2': 2139, '3': 2139}, '43': {'0': 658, '1': 658, '2': 658}, '44': {'0': 45716, '1': 91432, '2': 45716, '3': 91432, '4': 45716, '5': 45716, '6': 45716, '7': 45716}, '45': {'0': 53698, '1': 53698, '2': 53698, '3': 107396, '4': 53698}, '46': {'0': 42, '1': 42, '2': 42, '3': 42, '4': 42, '5': 42}, '47': {'0': 25664, '1': 12832, '2': 25664, '3': 12832, '4': 25664}, '48': {'0': 49340, '1': 49340, '2': 49340, '3': 98680, '4': 49340}, '49': {'0': 28630, '1': 14315, '2': 14315, '3': 28630, '4': 28630, '5': 57260, '6': 28630, '7': 14315, '8': 14315}, '50': {'0': 1396, '1': 1396, '2': 1396}, '51': {'0': 12362, '1': 12362, '2': 12362, '3': 12362}, '52': {'0': 2387, '1': 2387, '2': 2387, '3': 2387, '4': 2387, '5': 2387, '6': 4774}, '53': {'0': 63, '1': 63, '2': 63, '3': 63, '4': 63, '5': 63}, '54': {'0': 178, '1': 178, '2': 178, '3': 178, '4': 178, '5': 356, '6': 178, '7': 178}, '55': {'0': 398, '1': 398, '2': 796, '3': 398, '4': 398}, '56': {'0': 57, '1': 57, '2': 57}, '57': {'0': 21010, '1': 1043, '2': 1043, '3': 1043, '4': 1043, '5': 4202, '6': 1043, '7': 1043, '8': 1043, '9': 1043, '10': 1043, '11': 1043, '12': 1043, '13': 1043, '14': 1043, '15': 1043, '16': 1043, '17': 1043, '18': 1043, '19': 1043, '20': 1043, '21': 1058, '22': 2101, '23': 1058, '24': 1058, '25': 1058, '26': 1058, '27': 1058, '28': 1058, '29': 1058, '30': 1058, '31': 1058, '32': 1058, '33': 1058, '34': 1058, '35': 1058, '36': 1058, '37': 1058, '38': 1058, '39': 1058, '40': 1058, '41': 2101}, '58': {'0': 63, '1': 63, '2': 63, '3': 63, '4': 63, '5': 63}, '59': {'0': 222, '1': 222, '2': 444, '3': 222, '4': 222, '5': 222}, '60': {'0': 3321, '1': 6642, '2': 3321, '3': 6642, '4': 3321, '5': 3321, '6': 3321, '7': 3321, '8': 9963}, '61': {'0': 120, '1': 120, '2': 120, '3': 240, '4': 120, '5': 120, '6': 120, '7': 120, '8': 120, '9': 120, '10': 120, '11': 120, '12': 600, '13': 120, '14': 120, '15': 120, '16': 120, '17': 120, '18': 120, '19': 120, '20': 120}, '62': {'0': 190, '1': 190}, '63': {'0': 70, '1': 70, '2': 70, '3': 70}}

cell_clustering_alg= "km"

y_test_all, y_local_cell_ids, predicted_all, y_labeled_by_user_all,\
    unique_cells_local_index_collection, samples = \
        ed_twolevel_rahas_features.error_detector(cell_feature_generator_enabled, sandbox_path, column_groups_path, experiment_output_path, results_path,\
                                                  labeling_budget, number_of_column_clusters, cluster_sizes, cell_clustering_alg)
saving_results.get_all_results(tables_path, results_path, y_test_all, y_local_cell_ids, predicted_all, y_labeled_by_user_all,\
unique_cells_local_index_collection, samples)
